<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Wishes</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Sans+SC:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans SC', sans-serif;
            overflow: hidden;
            touch-action: manipulation;
            height: 100vh; /* Fallback */
            height: 100dvh; /* Mobile fix */
        }

        .font-art {
            font-family: 'Ma Shan Zheng', cursive;
        }

        /* Custom Animation Keyframes */
        @keyframes floatUp {
            0% {
                transform: translateY(110vh) scale(0.5) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-20vh) scale(1.2) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes burstOut {
            0% {
                transform: translate(0, 0) scale(0.5);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }

        .blessing-item {
            position: absolute;
            pointer-events: none;
            user-select: none;
            will-change: transform, opacity;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            z-index: 1;
        }

        /* Glassmorphism UI */
        .glass-panel {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Mobile Safety Spacing */
        .safe-pb {
            padding-bottom: env(safe-area-inset-bottom, 20px);
        }
    </style>
</head>
<body class="w-screen overflow-hidden transition-colors duration-1000 ease-in-out" id="app-body">

    <!-- Background Overlay -->
    <div id="bg-pattern" class="absolute inset-0 opacity-10 pointer-events-none z-0" style="background-image: radial-gradient(rgba(255,255,255,0.5) 1px, transparent 1px); background-size: 40px 40px;"></div>

    <!-- Main Content Container -->
    <div class="relative z-20 w-full h-full flex flex-col items-center justify-end safe-pb pb-4">
        
        <!-- Center Text (Title) - Adjusted Top Position -->
        <div class="absolute top-[40%] left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none z-0 w-full px-4">
            <h1 id="main-title" class="font-art text-5xl sm:text-6xl md:text-7xl text-white opacity-90 drop-shadow-lg transition-all duration-500 transform hover:scale-110">
                Êñ∞Âπ¥Âø´‰πê
            </h1>
            <p class="text-white/80 mt-2 sm:mt-4 text-base sm:text-lg animate-pulse">ÁÇπÂáªÂ±èÂπïÂèëÈÄÅÁ•ùÁ¶è</p>
        </div>

        <!-- Control Panel -->
        <div class="glass-panel rounded-2xl p-3 sm:p-4 flex flex-col gap-3 items-center w-[95%] max-w-md z-50 shadow-2xl mx-auto">
            <div class="text-white text-xs sm:text-sm font-bold tracking-widest opacity-80 uppercase">ÈÄâÊã©‰∏ªÈ¢ò</div>
            <div class="flex flex-wrap justify-center gap-2 w-full" id="theme-buttons">
                <!-- Buttons injected by JS -->
            </div>
            
            <div class="flex w-full gap-2 mt-1">
                <button id="toggle-auto" class="flex-1 bg-white/20 hover:bg-white/30 text-white py-2.5 sm:py-2 rounded-lg transition text-sm sm:text-base font-medium active:scale-95 border border-white/10 touch-manipulation">
                    ‚è∏ ÊöÇÂÅú
                </button>
                <button id="burst-btn" class="flex-1 bg-yellow-400/80 hover:bg-yellow-400 text-black py-2.5 sm:py-2 rounded-lg transition text-sm sm:text-base font-bold active:scale-95 shadow-[0_0_15px_rgba(250,204,21,0.6)] touch-manipulation">
                    üöÄ ÁãÇÊ¨¢Ê®°Âºè
                </button>
            </div>
        </div>
    </div>

    <!-- Container for dynamic elements -->
    <div id="blessing-container" class="absolute inset-0 pointer-events-none overflow-hidden z-10"></div>

    <script>
        // Configuration Data
        const themes = {
            newyear: {
                name: "Êò•ËäÇ",
                bgClass: "bg-gradient-to-b from-red-900 via-red-700 to-red-500",
                title: "Êñ∞Âπ¥Âø´‰πê",
                texts: ["ÊÅ≠ÂñúÂèëË¥¢", "‰∏á‰∫ãÂ¶ÇÊÑè", "Ë∫´‰ΩìÂÅ•Â∫∑", "Â§ßÂêâÂ§ßÂà©", "ÈæôÂπ¥Â§ßÂêâ", "Â≤ÅÂ≤ÅÂπ≥ÂÆâ", "Ë¥¢Ê∫êÂπøËøõ"],
                emojis: ["üßß", "üß®", "üèÆ", "üêâ", "ü•ü", "üí∞", "‚ú®"],
                color: "text-yellow-300",
                particleColor: "#FFD700"
            },
            birthday: {
                name: "ÁîüÊó•",
                bgClass: "bg-gradient-to-b from-pink-600 via-purple-500 to-indigo-500",
                title: "ÁîüÊó•Âø´‰πê",
                texts: ["ËÆ∏‰∏™ÊÑøÂêß", "Â§©Â§©ÂºÄÂøÉ", "Ê∞∏Ëøú18Â≤Å", "Ê¢¶ÊÉ≥ÊàêÁúü", "Âø´‰πêÂä†ÂÄç", "ËõãÁ≥ïÊù•Âï¶", "Happy Birthday"],
                emojis: ["üéÇ", "üéâ", "üéÅ", "üïØÔ∏è", "üéà", "ü•≥", "üëë"],
                color: "text-pink-100",
                particleColor: "#FF69B4"
            },
            love: {
                name: "Êµ™Êº´",
                bgClass: "bg-gradient-to-br from-rose-900 via-pink-700 to-rose-500",
                title: "ÊàëÁà±‰Ω†",
                texts: ["‰∏ÄÁîü‰∏Ä‰∏ñ", "Âπ∏Á¶èÁæéÊª°", "ÊâßÂ≠ê‰πãÊâã", "ÂøÉÂøÉÁõ∏Âç∞", "‰Ω†ÊòØÂîØ‰∏Ä", "Love You", "ÊØîÂøÉ"],
                emojis: ["‚ù§Ô∏è", "üåπ", "üíë", "üíå", "üíç", "üíñ", "ü•∞"],
                color: "text-rose-100",
                particleColor: "#FFC0CB"
            },
            cyber: {
                name: "ÊûÅÂÆ¢",
                bgClass: "bg-gradient-to-b from-slate-900 via-slate-800 to-black",
                title: "Hello World",
                texts: ["Bug Free", "1024", "Coding...", "Deploy", "Success", "AI", "Future"],
                emojis: ["üíª", "üöÄ", "ü§ñ", "‚ö°", "üíæ", "üåê", "üëæ"],
                color: "text-green-400",
                particleColor: "#00FF00"
            },
            wealth: {
                name: "ÊêûÈí±",
                bgClass: "bg-gradient-to-b from-yellow-800 via-yellow-600 to-amber-500",
                title: "Êö¥ÂØå",
                texts: ["ÊêûÈí±Ë¶ÅÁ¥ß", "Êó•ËøõÊñóÈáë", "‰∏çÂä≥ËÄåËé∑", "Ë¥¢Âä°Ëá™Áî±", "Êö¥ÂØåÊö¥Áò¶", "‰π∞‰π∞‰π∞", "Ê∂®Ê∂®Ê∂®"],
                emojis: ["üí∞", "üí∏", "ü§ë", "üíé", "üè¶", "üìà", "ü™ô"],
                color: "text-yellow-100",
                particleColor: "#FFD700"
            }
        };

        // State
        let currentThemeKey = 'newyear';
        let isAutoPlaying = true;
        let spawnInterval;
        const container = document.getElementById('blessing-container');
        const body = document.getElementById('app-body');
        const titleEl = document.getElementById('main-title');

        // --- Core Functions ---

        // Initialize Theme Buttons
        function initUI() {
            const btnContainer = document.getElementById('theme-buttons');
            Object.keys(themes).forEach(key => {
                const theme = themes[key];
                const btn = document.createElement('button');
                // Responsive button sizing
                btn.className = `flex-grow sm:flex-grow-0 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-xs sm:text-sm font-medium transition-all duration-300 border border-white/30 text-white hover:bg-white/20 active:scale-95 touch-manipulation ${key === currentThemeKey ? 'bg-white/30 ring-2 ring-white/50' : 'bg-transparent'}`;
                btn.innerText = theme.name;
                btn.onclick = (e) => {
                    e.stopPropagation();
                    setTheme(key);
                };
                btnContainer.appendChild(btn);
            });
        }

        // Set Theme Logic
        function setTheme(key) {
            currentThemeKey = key;
            const theme = themes[key];
            
            // Update Background
            body.className = `w-screen overflow-hidden transition-colors duration-1000 ease-in-out ${theme.bgClass}`;
            
            // Update Title
            titleEl.innerText = theme.title;
            titleEl.style.opacity = 0;
            setTimeout(() => {
                titleEl.style.opacity = 0.9;
            }, 300);

            // Update Buttons visual state
            const btns = document.getElementById('theme-buttons').children;
            Object.keys(themes).forEach((k, index) => {
                const btn = btns[index];
                if (k === key) {
                    btn.classList.add('bg-white/30', 'ring-2', 'ring-white/50');
                    btn.classList.remove('bg-transparent');
                } else {
                    btn.classList.remove('bg-white/30', 'ring-2', 'ring-white/50');
                    btn.classList.add('bg-transparent');
                }
            });
        }

        // Create a single floating element
        function spawnBlessing(x, y, isBurst = false) {
            const theme = themes[currentThemeKey];
            const el = document.createElement('div');
            
            // Decide content: text or emoji
            const isText = Math.random() > 0.4;
            const content = isText 
                ? theme.texts[Math.floor(Math.random() * theme.texts.length)]
                : theme.emojis[Math.floor(Math.random() * theme.emojis.length)];

            el.innerText = content;
            el.className = `blessing-item font-art font-bold absolute ${theme.color}`;
            
            // Responsive Styling
            const isMobile = window.innerWidth < 640;
            let sizeVal;
            
            if (isMobile) {
                // Smaller sizes for mobile to avoid clutter
                sizeVal = isText ? (Math.random() * 0.6 + 1.0) : (Math.random() * 1.0 + 1.5);
            } else {
                // Original sizes for desktop
                sizeVal = isText ? (Math.random() * 1.5 + 1.0) : (Math.random() * 2.0 + 1.5);
            }
            el.style.fontSize = sizeVal + 'rem';
            
            // Position
            if (isBurst) {
                el.style.left = x + 'px';
                el.style.top = y + 'px';
                
                // Burst Animation Physics
                const angle = Math.random() * Math.PI * 2;
                // Reduce velocity slightly on mobile to keep them on screen longer
                const velocity = isMobile ? (Math.random() * 100 + 40) : (Math.random() * 150 + 50);
                const tx = Math.cos(angle) * velocity + 'px';
                const ty = Math.sin(angle) * velocity + 'px';
                
                el.style.setProperty('--tx', tx);
                el.style.setProperty('--ty', ty);
                el.style.animation = `burstOut ${Math.random() * 0.5 + 0.5}s ease-out forwards`;
            } else {
                // Infinite Float Up Logic
                const startX = x !== undefined ? x : Math.random() * 100; // %
                el.style.left = startX + '%';
                el.style.bottom = '-10%'; // Start below screen
                
                const duration = Math.random() * 5 + 4; // 4-9s
                el.style.animation = `floatUp ${duration}s linear forwards`;
            }

            container.appendChild(el);

            // Cleanup
            el.addEventListener('animationend', () => {
                el.remove();
            });
        }

        // Automatic Spawning Loop
        function startAutoSpawn() {
            if (spawnInterval) clearInterval(spawnInterval);
            const isMobile = window.innerWidth < 640;
            const intervalTime = isMobile ? 500 : 300; // Slower spawn on mobile to reduce chaos

            spawnInterval = setInterval(() => {
                if(document.hidden) return; // Pause if tab hidden
                spawnBlessing();
            }, intervalTime);
        }

        function toggleAuto() {
            const btn = document.getElementById('toggle-auto');
            if (isAutoPlaying) {
                clearInterval(spawnInterval);
                btn.innerText = "‚ñ∂ ÁªßÁª≠";
                btn.classList.replace('bg-white/20', 'bg-green-500/50');
            } else {
                startAutoSpawn();
                btn.innerText = "‚è∏ ÊöÇÂÅú";
                btn.classList.replace('bg-green-500/50', 'bg-white/20');
            }
            isAutoPlaying = !isAutoPlaying;
        }

        // Burst Mode Logic (Many items at once)
        function triggerBurst(x, y) {
            const isMobile = window.innerWidth < 640;
            const count = isMobile ? 8 : 15; // Fewer items on mobile

            // Create visuals
            for (let i = 0; i < count; i++) {
                spawnBlessing(x, y, true);
            }
            
            // Add a few floating ones
            const floatCount = isMobile ? 1 : 3;
            for (let i = 0; i < floatCount; i++) {
                 setTimeout(() => spawnBlessing(), i * 100);
            }
        }

        // --- Event Listeners ---

        // Click/Touch on background
        document.addEventListener('click', (e) => {
            // Avoid triggering on buttons
            if (e.target.tagName === 'BUTTON' || e.target.closest('button')) return;
            triggerBurst(e.clientX, e.clientY);
        });

        // Manual Burst Button
        document.getElementById('burst-btn').addEventListener('click', (e) => {
            e.stopPropagation();
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            triggerBurst(centerX, centerY);
            if(window.innerWidth > 640) {
                triggerBurst(centerX, centerY); // Double dose only on desktop
            }
        });

        document.getElementById('toggle-auto').addEventListener('click', (e) => {
            e.stopPropagation();
            toggleAuto();
        });

        // Initialization
        initUI();
        setTheme('newyear');
        startAutoSpawn();

        // Handle Resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            // Debounce resize handling
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                // Restart auto spawn to adjust interval if switching between mobile/desktop
                if(isAutoPlaying) startAutoSpawn();
            }, 200);
        });

        // Fix iOS height issue
        function setMobileHeight() {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        window.addEventListener('resize', setMobileHeight);
        setMobileHeight();

    </script>
</body>
</html>
